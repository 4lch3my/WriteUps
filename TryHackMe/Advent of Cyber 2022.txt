///TASK 6///
Q: Who is the adversary that attacked Santa's network this year?
**
A: THM{IT'S A Y3T1 CHR1$TMA$}
===
Q: What's the flag that they left behind?
**
A: The Bandit Yeti!
===
///TASK 7///
Q: Use the ls command to list the files present in the current directory. How many log files are present?
** ls
A: 2
===
Q: Elf McSkidy managed to capture the logs generated by the web server. What is the name of this log file?
** ls
A: webserver.log
===
Q: On what day was Santa's naughty and nice list stolen?
** nano webserver.log > look at IP
A: Friday
===
Q: What is the IP address of the attacker?
** nano webserver.log > look at IP
A: 10.10.249.191
===
Q: What is the name of the important list that the attacker stole from Santa?
** grep
A: santaslist.txt
===
Q: Look through the log files for the flag. The format of the flag is: THM{}
** grep -r "THM{"
A: THM{STOLENSANTASLIST}
===
///TASK 8///
Q: What is the name of the Registrar for the domain santagift.shop?
** whois > check domain "santagift.shop"
A: NAMECHEAP INC
===
Q: Find the website's source code (repository) on github.com and open the file containing sensitive credentials. Can you find the flag?
** github search > config.php > OSINT
A: {THM_OSINT_WORKS}
===
Q: What is the name of the file containing passwords?
**
A: config.php
===
Q: What is the name of the QA server associated with the website?
**
A: qa.santagift.shop
===
Q: What is the DB_PASSWORD that is being reused between the QA and PROD environments?
**
A: S@nta2022
===
///TASK 9///
Q: What is the name of the HTTP server running on the remote host?
** nmap -sC -sV [IP_OF_SERVER]
A: apache
===
Q: What is the name of the service running on port 22 on the QA server?
** nmap -sS [IP_OF_SERVER]
A: ssh
===
Q: What flag can you find after successfully accessing the Samba service?
** file > smb://[IP_OF_SERVER] > ubuntu:S@nta2022 > flag.txt
A: {THM_SANTA_SMB_SERVER}
===
Q: What is the password for the username santahr?
** userlist.txt
A: santa25
///TASK 10///
Q: Use Hydra to find the VNC password of the target with IP address MACHINE_IP. What is the password?
** hydra -P /usr/share/wordlists/rockyou.txt ssh://10.10.128.35 -V -f -T 4
A: 1q2w3e4r
===
Q: Using a VNC client on the AttackBox, connect to the target of IP address MACHINE_IP. What is the flag written on the targetâ€™s screen?
** vnc > add password > loom at screen
A: THM{I_SEE_YOUR_SCREEN}
///TASK 11///
===
Q: What is the email address of the sender?
** 
A: chief.elf@santaclaus.thm
===
Q: What is the return address?
** 
A: murphy.evident@bandityeti.thm
===
Q: On whose behalf was the email sent?
** 
A: chief elf
===
Q: What is the X-spam score?
** emlAnalyzer -i Urgent\:.eml --header --html -u --text --extract-all
A: 3
===
Q: What is hidden in the value of the Message-ID field?
** copy > cyberchef > from base64
A: AoC2022_Email_Analysis
===
Q: What is the reputation result of the sender's email address?
**
A: RISKY
===
Q: What is the filename of the attachment?
**
A: Division_of_labour-Load_share_plan.doc
===
Q: What is the hash value of the attachment?
**
A: 0827bb9a2e7c0628b82256759f0f888ca1abd6a2d903acdb8e44aca6a1a03467
===
Q: What is the second tactic marked in the Mitre ATT&CK section?
** 
A: Defense Evasion
===
Q: What is the subcategory of the file?
** https://labs.inquest.net/ > hashfinder > add hash 
A: macro_hunter
===
///TASK 12///
Q: What is the version of CyberChef found in the attached VM?
** 
A: 9.49.0
===
Q: How many recipes were used to extract URLs from the malicious doc?
**
A: 10
===
Q: We found a URL that was downloading a suspicious file; what is the name of that malware?
**
A: mysterygift.exe
===
Q: What is the last defanged URL of the bandityeti domain found in the last step?
**
A: hxxps[://]cdn[.]bandityeti[.]THM/files/index/ 
===
Q: What is the ticket found in one of the domains? (Format: Domain/<GOLDEN_FLAG>)
**
A: THM_MYSTERY_FLAG
===
///TASK 13///
Q: What flag is found after attacking the provided EtherStore Contract?
**
A: flag{411_ur_37h_15_m1n3}
///TASK 14///
===
Q: Deploy the attached VM, and wait a few minutes. What ports are open?
** nmap -T4 -A -Pn MACHINE_IP
A: 80
===
Q: What framework is the web application developed with?
** Open MACHINE_IP:80 > check bottom left
A: laravel
===
Q: What CVE is the application vulnerable to?
** Quick google search
A: CVE-2021-3129
===
Q: What command can be used to upgrade the last opened session to a Meterpreter session?
** To check sessions: sessions
A: sessions -u -1
===
Q: What file indicates a session has been opened within a Docker container?
** Found in task, can't see on machine?
A: /.dockerenv
===
Q: What file often contains useful credentials for web applications?
** Open the first session (sessions -i -1), cat /var/www/.env
A: .env
===
Q: What database table contains useful credentials?
** run postgres://postgres:postgres@172.28.101.51/postgres sql='select * from users'
A: users
===
Q: What is Santa's password?
** 
A: p4$$w0rd
===
Q: What ports are open on the host machine?
** proxychains -q nmap -n -sT -Pn -p 22,80,443,5432 172.17.0.1
A:  22,80
===
Q: What is the root flag?
** (!!all run in: msf6 auxiliary(scanner/ssh/ssh_login) mode!!) run ssh://santa:p4$$w0rd@172.17.0.1  >> sessions -i -1 >> ls >> cat /root/root.txt
A: THM{47C61A0FA8738BA77308A8A600F88E4B}
===
///TASK 15///
===
Q: What is the Guard's flag?
** Talk to guard a 2nd time after defeating him (maybe you will need to die first...)
A: THM{5_star_Fl4gzzz}
===
Q: What is the Yeti's flag?
** follow instructions, >> memorymap 0x0004b4a4 (what is health) >> chanhe to 1000 and win
A: THM{yetiyetiyetiflagflagflag}
===
///TASK 16///
===
Q: What is the Windows version number that the memory image captured?
** python3 vol.py -f workstation.vmem windows.info
A: 10
===
Q: What is the name of the binary/gift that secret Santa left?
** python3 vol.py -f workstation.vmem windows.psscan
A: mysterygift.exe
===
Q: What is the Process ID (PID) of this binary?
** python3 vol.py -f workstation.vmem windows.pssca
A: 2040
===
Q: Dump the contents of this binary. How many files are dumped?
** python3 vol.py -f workstation.vmem windows.dumpfiles --pid 2040
A: 16
===
///TASK 17///
===
Q: What is the architecture of the malware sample? (32-bit/64-bit)
** Run Detect it Easy  on file > see under PE type
A: 64-bit
===
Q: What is the packer used in the malware sample? (format: lowercase)
** 
A: upx
===
Q: What is the compiler used to build the malware sample? (format: lowercase)
** capa mysterygift
A: nim
===
Q: How many MITRE ATT&CK techniques have been discovered attributed to the DISCOVERY tactic?
** capa mysterygift >> "ATT&CK Technique" section
A: 2
===
Q: What is the registry key abused by the malware?
** Follow instructions, see 1st time on list
A: HKCU\Software\Microsoft\Windows\CurrentVersion\Run\
===
Q: What is the value written on the registry key based on the previous question?
** Follow instructions, see 1st time on list
A: C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\wishes.bat
===
Q: What are the names of two files created by the malware under the C:\Users\Administrator\ directory? (format: file1,file2 in alphabetical order)
** Read from "File System" stream
A: test.jpg, wishes.bat
===
Q: What are the two domains wherein malware has initiated a network connection? (format: domain1,domain2 in alphabetical order)
** Read "Network Activity"
A: bestfestivalcompany.thm, virustotal.com
===
Q: Going back to strings inside the malware sample, what is the complete URL used to download the file hosted in the first domain accessed by the malware?
** 
A: http://bestfestivalcompany.thm/favicon.ico
===
///TASK 18///
===
Q: What is the "Percent Packets" value of the "Hypertext Transfer Protocol"?
** WireShark > Statistics > Protocol Hierarchy
A: 0.3
===
Q: Which port number has received more than 1000 packets?
** WireShark > Statistics > Conversations > select TCP
A: 3389
===
Q: What is the service name of the used protocol that received more than 1000 packets?
** port 3389 > common port
A: RDP
===
Q: What are the domain names?
** filter for 'dns' in WireShark
A: bestfestivalcompany[.]thm,cdn[.]bandityeti[.]thm
===
Q: What are the names of the requested files?
** filter for 'http' in WireShark
A: favicon[.]ico,mysterygift[.]exe
===
Q: Which IP address downloaded the executable file?
** filter for 'http' in WireShark >> source IP > cyberchef to defang
A: 10[.]10[.]29[.]186
===
Q: Which domain address hosts the malicious file?
** filter for 'http' in WireShark >> source IP > cyberchef to defang
A: cdn[.]bandityeti[.]thm
===
Q: What is the "user-agent" value used to download the non-executable file?
** filter for 'http' in WireShark >> click packet > hypertext > GET > [Expert > user-agent
A: Nim httpclient/1.6.8
===
Q: What is the sha256 hash value of the executable file?
** 1, WireShar on Desktop
** 2, cd Desktop > sha256sum > mysterygift.exe
A: 0ce160a54d10f8e81448d0360af5c2948ff6a4dbb493fe4be756fc3e2c3f900f
===
Q: What are the connected IP addresses?
** Follow Task > first 3 what are not local (192.168) nor DNS (8.8)
A: 20[.]99[.]133[.]109,20[.]99[.]184[.]37,23[.]216[.]147[.]76
===
///TASK 19///
Q: What is the office number of Elf Pivot McRed?
** IDOR meaning > testing the URl from '100.html' and above
A: 134
===
Q: Not only profile pages but also stored images are vulnerable. Start with a URL of a valid profile image; what is the hidden flag?
** 
A: THM{CLOSE_THE_DOOR}
===
///TASK 20///